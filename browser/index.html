<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Browser inference demo</title>

  <style>
    #features {
      width: 50%;
      font-size: 18px;
    }

    #results {
      font-family: monospace;
      white-space: pre;
    }
  </style>
</head>

<body>
  <h1></h1>

  <p>
    <input type="text" id="features" placeholder="Paste your features here">
  </p>
  <p>
    <button id="run-inference">Run inference</button>
  </p>
  <p id="results"></p>

  <p id="test1"></p>
  <p id="test2"></p>
  <p id="test3"></p>
  <p id="test4"></p>




  <script src="edge-impulse-standalone.js"></script>
  <script src="run-impulse.js"></script>
  <script>
    (async () => {
      var classifier = new EdgeImpulseClassifier();
      await classifier.init();

      let project = classifier.getProjectInfo();
      document.querySelector('h1').textContent = project.owner + ' / ' + project.name + ' (version ' + project.deploy_version + ')';

      document.querySelector('#run-inference').onclick = () => {
        try {
          let features = document.querySelector('#features').value.split(',').map(x => Number(x.trim()));
          let res = classifier.classify(features);
          document.querySelector('#results').textContent = JSON.stringify(res, null, 4);
        }
        catch (ex) {
          alert('Failed to classify: ' + (ex.message || ex.toString()));
        }
      };
    })();
  </script>
  <!-- <script>
    let acl = new Accelerometer({ frequency: 60 });
    acl.addEventListener('reading', () => {
      document.getElementById("test1").innerHTML =  acl.x;
      document.getElementById("test2").innerHTML =  acl.y;
      document.getElementById("test3").innerHTML =  acl.z;

      console.log("Acceleration along the X-axis " + acl.x);
      console.log("Acceleration along the Y-axis " + acl.y);
      console.log("Acceleration along the Z-axis " + acl.z);
    });

    acl.start();
  </script> -->

  <!-- <script>

    function getAccel(){
      DeviceMotionEvent.requestPermission().then(response => {
          if (response == 'granted') {
          // Add a listener to get smartphone acceleration 
              // in the XYZ axes (units in m/s^2)
              window.addEventListener('devicemotion', (event) => {
                  console.log(event);
                  document.getElementById("test3").innerHTML =  event;

              });
         // Add a listener to get smartphone orientation 
             // in the alpha-beta-gamma axes (units in degrees)
              window.addEventListener('deviceorientation',(event) => {
                  console.log(event);
                  document.getElementById("test2").innerHTML =  event;
                  
              });
          }
      });
  }
  </script> -->

  <script>
    let accelerometer = null;
    try {
      document.getElementById("test1").innerHTML = "smo v try";
      console.log("smo v tru")
      accelerometer = new Accelerometer({ frequency: 10 });

      document.getElementById("test4").innerHTML = accelerometer;

      accelerometer.onerror = (event) => {
        // Handle runtime errors.
        if (event.error.name === 'NotAllowedError') {
          document.getElementById("test2").innerHTML = "Permission to access sensor was denied.";
          console.log('Permission to access sensor was denied.');
        } else if (event.error.name === 'NotReadableError') {
          console.log('Cannot connect to the sensor.');
        }
      };
      accelerometer.onreading = (e) => {
        document.getElementById("test3").innerHTML = e;

        console.log(e);
      };
      accelerometer.start();
    } catch (error) {
      console.log("smo v catch")
      // Handle construction errors.
      if (error.name === 'SecurityError') {
        document.getElementById("test2").innerHTML =  "SecurityError";

        console.log('Sensor construction was blocked by the Permissions Policy.');
      } else if (error.name === 'ReferenceError') {
        document.getElementById("test2").innerHTML =  "ReferenceError";

        console.log('Sensor is not supported by the User Agent.');
      } else {
        document.getElementById("test2").innerHTML = error;
        
        throw error;
      }
    }
  </script>

</body>

</html>